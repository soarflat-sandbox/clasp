"use strict";function setTrigger(){var triggerDay=new Date();triggerDay.setHours(4);triggerDay.setMinutes(0);ScriptApp.newTrigger('main').timeBased().at(triggerDay).create();}function deleteTrigger(){var triggers=ScriptApp.getProjectTriggers();triggers.forEach(function(trigger){if(trigger.getHandlerFunction()=='main'){ScriptApp.deleteTrigger(trigger);}});}function main(){deleteTrigger();var spreadsheet=SpreadsheetApp.openById('1QOcgSLSLDkwB70kuAfXHZbmDhSvCTuPppZUpycotPUo');var sheet=spreadsheet.getSheetByName('master');var values=[['apple'],['banana'],['lemon']];sheet.getRange('A1:A3').setValues(values);sheet.getRange('B4').setValue('melon');sheet.appendRow(['a man','a plan','panama']);var date=sheet.getRange('B1').getValue();if(!date){sheet.getRange('B1').setValue(getTodayDate());}var response=UrlFetchApp.fetch("https://api.dmm.com/affiliate/v3/ItemList?api_id=".concat("xnLabZ6RPzndysrhW6VC","&affiliate_id=","hira777-999","&site=DMM.com&hits=20&sort=date&keyword=%E3%82%A2%E3%83%8B%E3%83%A1&gte_date=",date,"&output=json"));var data=JSON.parse(response.getContentText());var ids=data.result.items.map(function(item){return item.content_id;});var lastRow=sheet.getLastRow();var currentIds=sheet.getRange("A1:A".concat(lastRow)).getValues().map(function(v){return v[0];});Logger.log(currentIds);var filterdIds=ids.filter(function(id){return currentIds.indexOf(id)<0;}).map(function(id){return[id];});if(filterdIds.length<1)return;sheet.getRange("A".concat(lastRow,":A").concat(filterdIds.length+lastRow-1)).setValues(filterdIds);}